<!DOCTYPE html>
<html>

<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>JSFiddle sumbdcnk</title>

  <style>
    
  </style>

  
</head>
<body>
  <!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>分数タイムアタック！教科書表示版</title>
    <style>
        body { font-family: sans-serif; text-align: center; background: #fffde7; padding: 20px; }
        .game-card { background: white; padding: 30px; border-radius: 20px; border: 4px solid #ffca28; max-width: 550px; margin: auto; box-shadow: 0 8px 20px rgba(0,0,0,0.1); position: relative; }
        
        /* タイマーとスコア */
        .status-bar { display: flex; justify-content: space-between; font-size: 22px; font-weight: bold; margin-bottom: 15px; }
        #timer { color: #e53935; font-size: 30px; }
        
        /* 【重要】分数を縦に表示するスタイル */
        .fraction {
            display: inline-flex;
            flex-direction: column;
            vertical-align: middle;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin: 0 5px;
        }
        .fraction .numerator { border-bottom: 2px solid #333; padding: 0 5px; } /* 分子と分数線 */
        .fraction .denominator { padding: 0 5px; } /* 分母 */

        /* 図形表示エリア */
        .display-area { height: 180px; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .tape { height: 50px; border: 3px solid #333; border-radius: 8px; position: relative; overflow: hidden; }
        #original-tape { background-color: #ffb6c1; width: 360px; background-image: linear-gradient(to right, #333 2px, transparent 2px); background-repeat: repeat-x; }
        .circle { width: 140px; height: 140px; border-radius: 50%; border: 3px solid #333; position: relative; overflow: hidden; background: #ffb6c1; }

        /* 回答ボタン */
        .option-container { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
        .choice-btn { 
            padding: 10px 20px; 
            cursor: pointer; 
            background: #fff; 
            border: 3px solid #ffca28; 
            border-radius: 15px; 
            transition: 0.1s; 
        }
        .choice-btn:active { transform: scale(0.95); background: #fff9c4; }

        #overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.95); border-radius: 20px; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
        .big-btn { padding: 15px 40px; font-size: 24px; cursor: pointer; background: #ffca28; border: none; border-radius: 50px; font-weight: bold; }
    </style>
</head>
<body>

<div class="game-card">
    <div id="overlay">
        <h1>分数タイムアタック！</h1>
        <button class="big-btn" onclick="startGame()">スタート！</button>
    </div>

    <div class="status-bar">
        <div>のこり: <span id="timer">60</span>秒</div>
        <div>スコア: <span id="score">0</span></div>
    </div>

    <h2 id="question-text" style="display: flex; align-items: center; justify-content: center;">
        もとの大きさの <span id="target-fraction"></span> はどれかな？
    </h2>
    
    <div class="display-area">
        <div id="tape-area"><div id="original-tape" class="tape"></div></div>
        <div id="circle-area" style="display:none;"><div id="original-circle" class="circle"></div></div>
    </div>
    
    <div id="options" class="option-container"></div>
    <p id="message" style="height:30px; font-weight:bold;"></p>
</div>

<script>
    let score = 0;
    let timeLeft = 60;
    let timerId = null;
    let isPlaying = false;

    // 分数のHTMLを作る関数
    function createFractionHTML(num, den) {
        return `<div class="fraction"><div class="numerator">${num}</div><div class="denominator">${den}</div></div>`;
    }

    function startGame() {
        score = 0; timeLeft = 60; isPlaying = true;
        document.getElementById("overlay").style.display = "none";
        nextGame();
        timerId = setInterval(() => {
            timeLeft--;
            document.getElementById("timer").innerText = timeLeft;
            if (timeLeft <= 0) endGame();
        }, 1000);
    }

    function endGame() {
        isPlaying = false;
        clearInterval(timerId);
        document.getElementById("overlay").style.display = "flex";
        document.getElementById("overlay").innerHTML = `<h1>終了！</h1><p style="font-size:24px;">${score} 問正解！</p><button class="big-btn" onclick="location.reload()">もう一度</button>`;
    }

    function nextGame() {
        const optionsDiv = document.getElementById("options");
        const targetSpan = document.getElementById("target-fraction");
        const tapeArea = document.getElementById("tape-area");
        const circleArea = document.getElementById("circle-area");
        optionsDiv.innerHTML = "";

        const isCircle = Math.random() < 0.5;
        const d = [2, 3, 4, 8][Math.floor(Math.random() * 4)];
        
        // 問題文に縦書き分数をセット
        targetSpan.innerHTML = createFractionHTML(1, d);

        if (isCircle) {
            tapeArea.style.display = "none";
            circleArea.style.display = "block";
            let lines = "";
            for(let i=0; i<d; i++) lines += `transparent ${(360/d)*i}deg, #333 ${(360/d)*i}deg, #333 ${(360/d)*i+2}deg, transparent ${(360/d)*i+2}deg, `;
            document.getElementById("original-circle").style.background = `conic-gradient(${lines} #ffb6c1 0deg)`;
        } else {
            tapeArea.style.display = "block";
            circleArea.style.display = "none";
            document.getElementById("original-tape").style.backgroundSize = `${360/d}px 100%`;
        }

        // 選択肢（今回は図形をクリックさせる形式）
        let choices = [
            { val: 1/d, isCorrect: true, color: "#fff176" },
            { val: 2/d, isCorrect: false, color: "#ffb74d" },
            { val: 0.5/d, isCorrect: false, color: "#aed581" }
        ];
        choices.sort(() => Math.random() - 0.5);

        choices.forEach(c => {
            const btn = document.createElement("button");
            btn.className = "choice-btn";
            
            let obj = document.createElement("div");
            obj.className = (isCircle ? "circle" : "tape");
            if (isCircle) {
                obj.style.width = "60px"; obj.style.height = "60px";
                obj.style.background = `conic-gradient(${c.color} ${c.val * 360}deg, #eee 0deg)`;
            } else {
                obj.style.width = (300 * c.val) + "px";
                obj.style.backgroundColor = c.color;
                obj.style.height = "30px";
            }

            btn.onclick = () => {
                if (c.isCorrect) {
                    score++;
                    document.getElementById("score").innerText = score;
                    nextGame();
                } else {
                    document.getElementById("message").innerText = "ちがうよ！";
                    setTimeout(() => document.getElementById("message").innerText = "", 800);
                }
            };
            btn.appendChild(obj);
            optionsDiv.appendChild(btn);
        });
    }
</script>
</body>
</html>

  <script>
    
  </script>
</body>
</html>

